## Adapter description and scope

The EIP1271 adapter allows DAOs to collectively sign messages and typed data through signatures. EIP1271 is a contract signature standard that enables smart contract wallets to behave like EOAs (externally owned accounts). Signatures are critical when interacting with various types of decentralized applications. Developers use signatures for authentication, meta-transactions, order books, and anything that requires delegated permission or proof of ownership of an address. EIP1271 has widespread adoption and is used in applications like Argent and Snapshot.

## Adapter workflow

In order to register a signature with the DAO, a member must submit a proposal in which they specify the signature message digest, the signature, and the magic value to return on success.

The message digest must be the hash of the message to sign. This can be a simple message hash, a personal signature (message with special prefix), or a typed data signature (message created using structured data).

The proposal enters the voting process.

If the vote passes, the adapter returns the magic value when queried via the EIP1271 interface.

## Adapter configuration

DAORegistry Access Flags: `SUBMIT_PROPOSAL`.

ProposalFlags: `EXISTS`, `SPONSORED`, `PROCESSED`.

## Adapter state

- `signatureProposals`: all signature proposals handled by each DAO.
- `SignatureDetails`:
  - `signature`: the signature associated with this proposal. May be used to encode other attributes for efficiency, since it is not a real signature and would just be wasted storage space
  - `msgHash`: the digest of the data to sign
  - `magicValue`: the value to return if a signature proposal has passed

## Dependencies and interactions (internal / external)

- Voting

  - starts new voting for the signature proposal.
  - checks the voting results.

## Functions description and assumptions / checks

### function submitProposal

```solidity
    /**
     * @notice Creates and sponsors a signature proposal
     * @dev Only members of the DAO can sponsor a financing proposal.
     * @param dao The DAO Address.
     * @param proposalId The proposal id.
     * @param signature The signature associated with this proposal
     * @param msgHash The digest of the data to be signed
     * @param magicValue The value to be returned by the EIP1271 interface upon success
     * @param details Additional detais about the signature proposal.
     */
    function submitProposal(
        DaoRegistry dao,
        bytes32 proposalId,
        bytes signature,
        bytes32 msgHash,
        bytes4 magicValue,
        bytes memory details
    ) external override
```

### function processProposal

```solidity
    /**
     * @notice Processing a signature proposal to mark the signature as valid
     * @dev Only proposals that were not processed are accepted.
     * @dev Only proposals that were sponsored are accepted.
     * @dev Only proposals that passed can get processed
     * @param dao The DAO Address.
     * @param proposalId The proposal id.
     */
    function processProposal(DaoRegistry dao, bytes32 proposalId)
        external
        override
```


## Events

List all the events that are emitted by the function in this Adapter implementation.

`event SignatureProposed(address AdapterAddress, bytes32 MessageDigest)`
`event SignatureProcessed(address AdapterAddress, bytes32 MessageDigest)`
